<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>River Tournament - River Tournament</title>
<style>
:root {
  --darkest: #141414;
  --dark-navy: #0D1B2A;
  --mid-navy: #002B3A;
  --accent-blue: #0071a4;
  --slate: #151D23;
  --white: #f5f5f5;
}

body {
  margin: 0;
  font-family: Arial, sans-serif;
  background-color: var(--darkest);
  color: var(--white);
  overflow-x: hidden;

  display: flex;
  flex-direction: column;
}

nav {
  position: relative;
  background-color: var(--dark-navy);
  box-shadow: 0 2px 4px rgba(0,0,0,0.3);
}

nav a {
  color: var(--white);
  text-decoration: none;
  display: block;
  padding: 1rem;
  font-weight: bold;
  transition: background-color 0.3s, color 0.3s;
}

nav a:hover {
  background-color: var(--accent-blue);
  color: var(--darkest);
}

.hamburger {
  display: block;
  cursor: pointer;
  padding: 1rem;
  font-size: 1.5rem;
  color: var(--white);
  position: absolute;
  left: 1rem;
  top: 0.5rem;
  z-index: 1001;
}

#menu-toggle {
  display: none;
}

.menu {
  flex-direction: column;
  position: absolute;
  top: 0;
  left: 0;
  background: var(--dark-navy);
  width: 200px;
  height: 100vh;
  padding-top: 4rem;
  transform: translateX(-200px);
  transition: transform 0.3s ease;
  z-index: 1000;
}

#menu-toggle:checked ~ .menu {
  transform: translateX(0);
}

header {
  text-align: center;
  background: linear-gradient(135deg, var(--dark-navy), var(--mid-navy));
  padding: 3rem 1rem;
  position: relative;
}

header h1 {
  font-family: Georgia, serif;
  font-size: 2.5rem;
  margin: 0;
  color: var(--accent-blue);
}

header p {
  font-size: 1rem;
  max-width: 90%;
  margin: 1rem auto 0;
  color: var(--white);
}

main {
  max-width: 800px;
  margin: 2rem auto;
  padding: 2rem;
  background-color: var(--slate);
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);

  flex: 1 0 auto;
}

footer {
  text-align: center;
  padding: 1rem;
  background-color: var(--dark-navy);
  color: var(--white);
  box-shadow: 0 -2px 4px rgba(0,0,0,0.3);
  margin-top: 2rem;

  flex-shrink: 0;
}
</style>
</head>
<body>

<nav>
  <input type="checkbox" id="menu-toggle" />
  <div class="menu">
    <a href="/RiverTournament/">Home</a>
    <a href="/RiverTournament/rules/">Rules</a>
    <a href="/RiverTournament/signup/">Sign Up</a>
    <a href="/RiverTournament/faq/">FAQ</a>
    <a href="/RiverTournament/stats/">Stats</a>
    <a href="/RiverTournament/photos/">Photos</a>
    <a href="/RiverTournament/contact/">Contact</a>
  </div>
  <label for="menu-toggle" class="hamburger">&#9776;</label>
</nav>

<header>
  <h1>River Tournament</h1>
  
    <p>Weekly pool tournaments at River Pool and Sports Bar. Cash prizes, bragging rights, and unforgettable nights!</p>
  
</header>

<main>
  <h1 id="tournament-date" style="text-align: center; font-size: 2rem; margin: 1rem 0;">Loading Bracket...</h1>

<p style="text-align: center; max-width: 600px; margin: 1rem auto; font-size: 1rem;">
  Want to join this week's tournament? 
  <a href="/signup.html" style="color: #0071a4; text-decoration: underline;">Sign up here!</a>
</p>

<div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 2rem;">
  <div style="flex: 1; min-width: 300px; max-width: 500px;">
    <h2 style="text-align: center;">Bracket</h2>
    <ul id="bracket" style="list-style: none; padding: 0; margin: 0; background-color: var(--slate); border-radius: 4px;"></ul>
  </div>
  <div style="flex: 1; min-width: 300px; max-width: 500px;">
    <h2 style="text-align: center;">Waitlist</h2>
    <ul id="waitlist" style="list-style: none; padding: 0; margin: 0; background-color: var(--slate); border-radius: 4px;"></ul>
  </div>
</div>

<p style="text-align: center; max-width: 600px; margin: 1rem auto; font-size: 0.9rem;">
  Even if the tables are full, spots are not guaranteed until registration is complete, including Fargo rate verification and entry fee payment. 
  Last-minute cancellations, no-shows, or Fargo rating changes can open up spots. 
  Bracket order does not indicate play order or bracket position. 
  Please text the tournament director at <a href="tel:7607938319" style="color: #0071a4; text-decoration: underline;">760-793-8319</a> to confirm availability.
</p>

<script>
  // Calculate this week's tournament date based on 7:31pm Thursday cutoff
  function getTournamentDate() {
    const now = new Date();
    const cutoffHour = 19;
    const cutoffMinute = 31;
    const dayOfWeek = now.getDay();
    const daysUntilThursday = (4 - dayOfWeek + 7) % 7 || 7;
    const thisThursday = new Date(now.getFullYear(), now.getMonth(), now.getDate() + daysUntilThursday - (dayOfWeek <= 4 ? 0 : 7));
    thisThursday.setHours(cutoffHour);
    thisThursday.setMinutes(cutoffMinute);
    thisThursday.setSeconds(0);

    let tournamentDate;
    if (now < thisThursday) {
      const tournamentThisThursday = new Date(now.getFullYear(), now.getMonth(), now.getDate() + (4 - dayOfWeek));
      tournamentDate = tournamentThisThursday;
    } else {
      const tournamentNextThursday = new Date(now.getFullYear(), now.getMonth(), now.getDate() + ((4 - dayOfWeek + 7) % 7 || 7));
      tournamentDate = tournamentNextThursday;
    }
    const options = { month: 'long', day: 'numeric', year: 'numeric' };
    document.getElementById('tournament-date').textContent = `${tournamentDate.toLocaleDateString('en-US', options)} Bracket`;
    return tournamentDate.toISOString().split('T')[0];
  }

  const tournamentDate = getTournamentDate();

  // Fetch and fill bracket and waitlist with placeholders
  fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vT5ck-1B7HvfNdb83vap3DeZJNT4PBWdLeNoGIm5WM7BbxVw-8nIa0VAVEfo3iv3G5Zs8W5vHt-Wjnr/pub?output=csv')
    .then(response => response.text())
    .then(data => {
      const rows = data.trim().split('\n').slice(1).map(row => row.split(','));
      const bracketList = document.getElementById('bracket');
      const waitlistList = document.getElementById('waitlist');

      let bracketCount = 0;
      let waitlistCount = 0;

      rows.forEach(row => {
        const [signUpTime, firstName, lastName, , , , , newPlayer, tournamentDateField, approved] = row.map(cell => cell.trim());
        if (tournamentDateField !== tournamentDate) return;

        const lastInitial = lastName ? lastName.charAt(0) + '.' : '';
        const displayName = firstName ? `${firstName} ${lastInitial}` : '';

        if (approved === 'TRUE' && bracketCount < 16) {
          const li = document.createElement('li');
          li.textContent = displayName;
          li.style.padding = '0.5rem';
          bracketList.appendChild(li);
          bracketCount++;
        } else if (approved !== 'TRUE' && waitlistCount < 16) {
          const li = document.createElement('li');
          li.textContent = displayName;
          li.style.padding = '0.5rem';
          waitlistList.appendChild(li);
          waitlistCount++;
        }
      });

      while (bracketCount < 16) {
        const li = document.createElement('li');
        li.textContent = '';
        li.style.padding = '0.5rem';
        bracketList.appendChild(li);
        bracketCount++;
      }

      while (waitlistCount < 16) {
        const li = document.createElement('li');
        li.textContent = '';
        li.style.padding = '0.5rem';
        waitlistList.appendChild(li);
        waitlistCount++;
      }
    })
    .catch(error => console.error('Error fetching data:', error));
</script>

</main>

<footer>
  &copy; 2025 Brittany Posey - All Rights Reserved
</footer>

<script>
(function() {
  const toggle = document.getElementById('menu-toggle');
  const isDesktop = window.matchMedia('(min-width: 1025px)').matches;

  if (isDesktop) {
    // On desktop, open by default (saved state from localStorage)
    if (localStorage.getItem('menuOpen') === 'true' || !localStorage.getItem('menuOpen')) {
      toggle.checked = true;
    }

    toggle.addEventListener('change', () => {
      localStorage.setItem('menuOpen', toggle.checked);
    });
  } else {
    // On mobile, closed by default
    toggle.checked = false;

    // Automatically close on new page load
    const links = document.querySelectorAll('.menu a');
    links.forEach(link => {
      link.addEventListener('click', () => {
        toggle.checked = false;
      });
    });
  }
})();
</script>

</body>
</html>
