<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Sign Up - River Tournament</title>
<style>
:root {
  --darkest: #141414;
  --dark-navy: #0D1B2A;
  --mid-navy: #002B3A;
  --accent-blue: #0071a4;
  --slate: #151D23;
  --white: #f5f5f5;
}

body {
  margin: 0;
  font-family: Arial, sans-serif;
  background-color: var(--darkest);
  color: var(--white);
  overflow-x: hidden;

  display: flex;
  flex-direction: column;
}

nav {
  position: relative;
  background-color: var(--dark-navy);
  box-shadow: 0 2px 4px rgba(0,0,0,0.3);
}

nav a {
  color: var(--white);
  text-decoration: none;
  display: block;
  padding: 1rem;
  font-weight: bold;
  transition: background-color 0.3s, color 0.3s;
}

nav a:hover {
  background-color: var(--accent-blue);
  color: var(--darkest);
}

.hamburger {
  display: block;
  cursor: pointer;
  padding: 1rem;
  font-size: 1.5rem;
  color: var(--white);
  position: absolute;
  left: 1rem;
  top: 0.5rem;
  z-index: 1001;
}

#menu-toggle {
  display: none;
}

.menu {
  flex-direction: column;
  position: absolute;
  top: 0;
  left: 0;
  background: var(--dark-navy);
  width: 200px;
  height: 100vh;
  padding-top: 4rem;
  transform: translateX(-200px);
  transition: transform 0.3s ease;
  z-index: 1000;
}

#menu-toggle:checked ~ .menu {
  transform: translateX(0);
}

header {
  text-align: center;
  background: linear-gradient(135deg, var(--dark-navy), var(--mid-navy));
  padding: 3rem 1rem;
  position: relative;
}

header h1 {
  font-family: Georgia, serif;
  font-size: 2.5rem;
  margin: 0;
  color: var(--accent-blue);
}

header p {
  font-size: 1rem;
  max-width: 90%;
  margin: 1rem auto 0;
  color: var(--white);
}

main {
  max-width: 800px;
  margin: 2rem auto;
  padding: 2rem;
  background-color: var(--slate);
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);

  flex: 1 0 auto;
}

footer {
  text-align: center;
  padding: 1rem;
  background-color: var(--dark-navy);
  color: var(--white);
  box-shadow: 0 -2px 4px rgba(0,0,0,0.3);
  margin-top: 2rem;

  flex-shrink: 0;
}
</style>
</head>
<body>

<nav>
  <input type="checkbox" id="menu-toggle" />
  <div class="menu">
    <a href="/RiverTournament/">Home</a>
    <a href="/RiverTournament/rules/">Rules</a>
    <a href="/RiverTournament/signup/">Sign Up</a>
    <a href="/RiverTournament/faq/">FAQ</a>
    <a href="/RiverTournament/stats/">Stats</a>
    <a href="/RiverTournament/photos/">Photos</a>
    <a href="/RiverTournament/contact/">Contact</a>
  </div>
  <label for="menu-toggle" class="hamburger">&#9776;</label>
</nav>

<header>
  <h1>Sign Up</h1>
  
</header>

<main>
  <p>Please ensure that your name matches your photo ID and the name on your Fargo account. All information will be verified at tournament registration.</p>

<form id="signup-form" style="display: flex; flex-direction: column; max-width: 400px; margin: 2rem auto; background-color: var(--dark-navy); padding: 1rem; border-radius: 8px;">
  <label for="first-name">First Name:</label>
  <input type="text" id="first-name" name="First Name" required style="margin-bottom: 1rem;">

  <label for="last-name">Last Name:</label>
  <input type="text" id="last-name" name="Last Name" required style="margin-bottom: 1rem;">

  <label for="preferred-name">Preferred Name:</label>
  <input type="text" id="preferred-name" name="Preferred Name" style="margin-bottom: 1rem;">

  <label for="phone">Phone Number:</label>
  <input type="tel" id="phone" name="Phone Number" style="margin-bottom: 1rem;">

  <label for="email">Email Address:</label>
  <input type="email" id="email" name="Email" style="margin-bottom: 1rem;">

  <label>
    <input type="checkbox" id="new-player" name="New Player" style="margin-bottom: 1rem;">
    Iâ€™m a new player / I do not have a Fargo account yet.
  </label>

  <label for="fargo-screenshot">Fargo Rating Screenshot (if you have one):</label>
  <input type="file" id="fargo-screenshot" name="Fargo Screenshot" accept="image/*" style="margin-bottom: 1rem;">

  <button type="submit" style="padding: 0.5rem; background-color: var(--accent-blue); color: var(--white); border: none; border-radius: 4px; cursor: pointer;">Submit</button>
</form>

<p id="status-message" style="text-align: center; margin-top: 1rem;"></p>

<!-- Load Google reCAPTCHA Enterprise v3 script -->
<script src="https://www.google.com/recaptcha/enterprise.js?render=6LcrZlMrAAAAAEkUlrB_4bEz3PnF73h6jmBmb5o_"></script>

<script>
  const form = document.getElementById('signup-form');
  const statusMessage = document.getElementById('status-message');

  form.addEventListener('submit', function(event) {
    event.preventDefault();

    grecaptcha.enterprise.ready(() => {
      grecaptcha.enterprise.execute('6LcrZlMrAAAAAEkUlrB_4bEz3PnF73h6jmBmb5o_', {action: 'submit'})
        .then(function(token) {
          submitForm(token);
        });
    });
  });

  function submitForm(token) {
    const formData = new FormData(form);
    const fileInput = document.getElementById('fargo-screenshot');
    const file = fileInput.files[0];

    const data = new URLSearchParams();
    data.append('First Name', formData.get('First Name'));
    data.append('Last Name', formData.get('Last Name'));
    data.append('Preferred Name', formData.get('Preferred Name'));
    data.append('Phone Number', formData.get('Phone Number'));
    data.append('Email', formData.get('Email'));
    data.append('New Player', formData.get('New Player') ? 'Yes' : 'No');
    data.append('g-recaptcha-response', token);

    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        const base64String = e.target.result;
        data.append('Fargo Screenshot', base64String);
        sendToAppsScript(data);
      };
      reader.readAsDataURL(file);
    } else {
      data.append('Fargo Screenshot', '');
      sendToAppsScript(data);
    }
  }

  function sendToAppsScript(data) {
    fetch('https://script.google.com/macros/s/AKfycbx66jj5zCl5ZLMEiffsyv6DRyUsdD4j-DXGxnABc7sL781DH8bsrsWyg9QSTL-2wP-PVQ/exec', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/x-www-form-urlencoded',
  },
  body: data.toString()
})
    .then(response => response.text())
    .then(text => {
      console.log('Response from Apps Script:', text); // testing line
	  statusMessage.textContent = 'Thanks for signing up! Your reservation is pending. Check the Bracket and Waitlist on the home page for updates.';
      form.reset();
    })
    .catch(error => {
      statusMessage.textContent = 'There was an error submitting your sign-up. Please try again.';
      console.error('Error:', error);
    });
  }
</script>

</main>

<footer>
  &copy; 2025 Brittany Posey - All Rights Reserved
</footer>

<script>
(function() {
  const toggle = document.getElementById('menu-toggle');
  const isDesktop = window.matchMedia('(min-width: 1025px)').matches;

  if (isDesktop) {
    // On desktop, open by default (saved state from localStorage)
    if (localStorage.getItem('menuOpen') === 'true' || !localStorage.getItem('menuOpen')) {
      toggle.checked = true;
    }

    toggle.addEventListener('change', () => {
      localStorage.setItem('menuOpen', toggle.checked);
    });
  } else {
    // On mobile, closed by default
    toggle.checked = false;

    // Automatically close on new page load
    const links = document.querySelectorAll('.menu a');
    links.forEach(link => {
      link.addEventListener('click', () => {
        toggle.checked = false;
      });
    });
  }
})();
</script>

</body>
</html>
